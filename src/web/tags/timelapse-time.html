<timelapse-time>
  <div class="padded-full">
      <div class="input-wrapper">
        <input class="with-label" type="time" step="1" min="1" name="time"
            oninput="{ setTimeAndInterval }"
            value="{ state().timelapse.time.format('hh:mm:ss', { trim: false }) }">
        <label class="floating-label" for="speed">Time</label>
      </div>
      <div class="input-wrapper">
        <input class="with-label" type="time" step="0.100" min="0.100" name="interval"
            oninput="{ setTimeAndInterval }"
            value="{ state().timelapse.interval.format('hh:mm:ss.SSS', { trim: false }) }">
        <label class="floating-label" for="speed">Interval</label>
      </div>
      <div class="input-wrapper">
        <input class="with-label" type="time" step="0.100" min="0.000" name="exposure"
            oninput="{ parent.setExposure }"
            value="{ state().timelapse.exposure.format('hh:mm:ss.SSS', { trim: false }) }">
        <label class="floating-label" for="speed">Exposure</label>
      </div>

      <table class="table padded-top" style="width: 100%">
        <tr>
          <thead>
            <th>Shots</th>
            <th each="{ fps, i in parent.fps }">{ fps }fps</th>
          </thead>
        </tr>
        <tbody>
          <tr>
              <td>
                { Math.round(state().timelapse.shots) }
              </td>
              <td each="{ fps, i in parent.fps }">
                { parent.parent.durationAt(fps).format('h[h] m[m] s[s]') }
              </td>
          </tr>
        </tbody>
      </table>

      <button class="btn fit-parent primary padded-top"
        disabled="{ state().tmcl.pending.length > 0 }"
        onclick="{ parent.start }">Start</button>
        
      <button class="btn fit-parent negative padded-top" onclick="{ parent.stop }">Stop</button>
  </div>

  <script>
    import moment from 'moment';
    import { setTimeAndInterval } from '../js/actions/timelapse'

    this.setTimeAndInterval = () => {
      let time = moment.duration(this.time.value)
      let interval = moment.duration(this.interval.value)
      this.store.dispatch(setTimeAndInterval(time, interval))
    }

    this.store.on('change', () => this.update())

    this.on('mount', () => {
      this.exposure.value = '00:00:00.100';
    });
  </script>
</timelapse-time>
