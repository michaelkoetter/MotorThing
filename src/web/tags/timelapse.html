<timelapse class="app-page">
  <header class="header-bar">
      <a data-navigation="$previous-page" class="btn pull-left icon icon-arrow-back"></a>
      <div class="center">
          <h1 class="title">Timelapse</h1>
      </div>
  </header>
  <nav class="tabs header-tabs">
      <div class="tab-items">
          <a class="tab-item">Quantity</a>
          <a class="tab-item">Time</a>
      </div>
      <div class="tab-indicator"></div>
  </nav>
  <div class="content" data-tab-contents="true" data-disable-swipe="false" data-tab-default="1" >
      <div class="tab-content">
          <timelapse-quantity />
      </div>
      <div class="tab-content">
          <timelapse-time />
      </div>
  </div>

  <script>
    import moment from 'moment'
    import { setExposure } from '../js/actions/timelapse'
    import { startTimelapse, stopTimelapse } from '../js/timelapseAPI'

    // TODO make this configurable
    this.fps = [
      24, 25, 30
    ]

    this.durationAt = (fps) => {
      let shots = this.state().timelapse.shots;
      return moment.duration(1 / fps * shots, 'seconds')
    }

    this.start = () => {
      startTimelapse()
    }

    this.stop = () => {
      stopTimelapse()
    }

    this.setExposure = (e) => {
      let exposure = moment.duration(e.target.value)
      this.store.dispatch(setExposure(exposure))
    }
  </script>
</timelapse>
